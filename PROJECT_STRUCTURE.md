# 项目代码结构说明 (Project Structure)

本文档详细说明了 `自适应图片比例边框处理软件` 项目中各个 Python 文件的作用。

## 根目录 (Root)

| 文件名        | 作用                                                                                                                                    |
| :------------ | :-------------------------------------------------------------------------------------------------------------------------------------- |
| `build_v1.py` | **打包脚本**。用于将项目打包成独立的 `.exe` 可执行文件。它配置了 PyInstaller 参数（如图标、隐藏控制台、包含资源等）并清理旧的构建文件。 |

## 源代码目录 (adaptive_glass)

这是项目的主要源码目录。

| 文件名                       | 作用                                                                                       |
| :--------------------------- | :----------------------------------------------------------------------------------------- |
| `main.py`                    | **程序入口**。负责初始化 `QApplication`，设置全局图标，并启动主窗口 (`MainWindow`)。       |
| `verify.py`                  | **验证脚本**。用于在开发过程中快速测试某些功能或验证环境配置（非生产代码）。               |
| `verify_adaptive.py`         | **自适应功能测试脚本**。专门用于测试图片比例自适应和背景模糊算法的独立脚本（非生产代码）。 |
| `verify_watermark_revert.py` | **水印还原验证脚本**。用于验证智能水印模块还原后的功能正确性（非生产代码）。               |

### 核心逻辑 (src/core)

包含图像处理的核心算法，不依赖于 UI。

| 文件名              | 作用                                                                                                                          |
| :------------------ | :---------------------------------------------------------------------------------------------------------------------------- |
| `processor.py`      | **图像处理器**。包含核心的图像处理逻辑，如：调整图片比例、生成模糊背景、添加边框、圆角和阴影等。                              |
| `watermark.py`      | **水印处理器**。负责水印的生成和绘制，支持文字水印（读取 EXIF 或自定义）和 Logo 水印，以及水印的位置和样式控制。              |
| `utils.py`          | **工具类**。包含通用的辅助函数（如 `get_resource_path` 用于资源路径处理）和数据类定义（如 `ProcessingSettings` 配置项结构）。 |
| `preset_manager.py` | **预设管理器**。负责将当前的图片处理设置保存为 JSON 文件，以及从文件加载预设配置。                                            |

### 用户界面 (src/ui)

包含基于 PyQt6 的界面实现。

| 文件名            | 作用                                                                                                              |
| :---------------- | :---------------------------------------------------------------------------------------------------------------- |
| `main_window.py`  | **主窗口**。定义了程序的主界面布局，负责组装各个 UI 组件（预览、设置），并处理菜单栏动作和拖拽事件。              |
| `preview.py`      | **预览组件**。自定义的 Widget，用于实时显示处理后的图片效果，并支持交互操作（如拖拽移动水印位置）。               |
| `settings.py`     | **设置面板**。右侧的控制面板，包含所有可调节的参数（比例、模糊度、边框、水印设置等）的 UI 控件。                  |
| `batch_dialog.py` | **批量处理对话框**。独立的弹窗界面，用于选择多个文件或文件夹进行批量图片处理。                                    |
| `workers.py`      | **后台工作线程**。包含 `ImageWorker`（处理预览）和 `SaveWorker`（保存文件），确保耗时的图像处理操作不会卡死界面。 |
| `styles.py`       | **样式表**。定义了应用程序的 QSS 样式（如深色模式主题），控制界面的视觉外观。                                     |

## 资源目录 (resources)

- `logos/`: 存放应用程序图标 (`.ico`, `.png`)。
- `fonts/`: 存放水印使用的字体文件。
